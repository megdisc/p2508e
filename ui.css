/* =================================================================== */
/* 5. コンポーネントスタイル (Component Classes)
/* =================================================================== */

/* -------------------------------------- */
/* 5.1. レイアウト (Layout) (★変更)
/* -------------------------------------- */
.page-wrapper {
    display: flex;
    height: 100vh; /* 画面全体の高さ */
}

.sidebar {
    width: var(--layout-sidebar-width);
    height: 100vh;
    position: fixed; /* 左側に固定 */
    top: 0;
    left: 0;
    background-color: var(--color-theme-main); /* テーマのメインカラー */
    color: var(--color-base-primary); /* テキストは白 */
    display: flex;
    flex-direction: column;
    border-right: 1px solid var(--palette-translucent-0002); /* 濃色背景用の罫線 */
    z-index: var(--z-index-sticky);
    overflow: hidden;
}

.main-content {
    flex-grow: 1;
    margin-left: var(--layout-sidebar-width); /* サイドバーの幅だけマージン */
    height: 100vh;
    overflow-y: auto; /* メインコンテンツのみスクロール */
}

.container {
    width: 100%;
    max-width: var(--container-max-width);
    margin-left: auto;
    margin-right: auto;
    padding-left: var(--spacing-inset-md);
    padding-right: var(--spacing-inset-md);
}

/* -------------------------------------- */
/* 5.2. カード (Card)
/* -------------------------------------- */
.card {
    background-color: var(--color-card-background);
    border: var(--color-card-border);
    border-radius: var(--radius-card);
    box-shadow: var(--shadow-card);
    padding: var(--spacing-card-padding);
    overflow: hidden;
}

.card-header {
    font-size: var(--font-size-md); /* ★ 20px */
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--spacing-stack-sm);
    padding-bottom: var(--spacing-stack-sm);
    border-bottom: var(--border-default);
}

.card-body {
    font-size: var(--font-size-sm); /* ★ 16px */
}

/* -------------------------------------- */
/* 5.2.1. カードグリッド (Card Grid) (★新規追加)
/* -------------------------------------- */
.card-grid {
    display: grid;
    
    /* カード間の隙間 (globals.css L2/L3 で定義済みの変数) */
    gap: var(--spacing-stack-md);

    /*
     * レスポンシブ・グリッド定義:
     * 1. auto-fill: コンテナ幅に収まる限り、列を自動的に充填する
     * 2. minmax(300px, 1fr):
     * - 各列（カード）の最小幅を 320px に
     * - 最小幅を超えた場合、残りのスペースを均等に分割 (1fr)
     */
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
}

/* -------------------------------------- */
/* 5.3. ボタン (Button)
/* (★セマンティックカラー全対応)
/* -------------------------------------- */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-button-padding-y) var(--spacing-button-padding-x);
    border-radius: var(--radius-button);
    font-weight: var(--font-weight-medium); /* ★ 600 */
    font-size: var(--font-size-sm); /* ★ 16px */
    text-decoration: none;
    cursor: pointer;
    transition: all var(--transition-duration-fast) var(--transition-timing-ease);
    border-style: solid;
    border-width: var(--border-width-sm);
    white-space: nowrap;
}

.btn:hover {
    opacity: 0.8;
}

.btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* (★背景=Main / テキスト=White) */
.btn-primary {
    /* (★) globals.css (L3) の定義を参照するように修正 */
    background-color: var(--color-button-primary-background);
    color: var(--color-button-primary-text);
    border-color: var(--color-button-primary-border);
}

.btn-success {
    background-color: var(--color-semantic-success-main);
    color: var(--color-base-primary);
    border-color: var(--color-semantic-success-main);
}

.btn-warning {
    background-color: var(--color-semantic-warning-main);
    color: var(--color-base-primary);
    border-color: var(--color-semantic-warning-main);
}

.btn-error {
    background-color: var(--color-semantic-error-main);
    color: var(--color-base-primary);
    border-color: var(--color-semantic-error-main);
}

.btn-cancelled {
    background-color: var(--color-semantic-cancelled-sub);
    color: var(--color-semantic-cancelled-main);
    border-color: var(--color-semantic-cancelled-sub);
}

/* (★背景=Sub / テキスト=Main) */
.btn-neutral {
    background-color: var(--color-semantic-neutral-sub);
    color: var(--color-semantic-neutral-main);
    border-color: var(--color-semantic-neutral-sub);
}

/* (★) アイコンボタン (ベース形状) */
.btn.btn-icon {
    width: 2.5rem; /* 40px */
    height: 2.5rem; /* 40px */
    padding: 0; /* (★) paddingリセット */
    border-radius: 50%; /* (★) 円形 */
    font-size: 1.25rem; /* アイコンサイズ (20px) */
    
    /* (★★) アイコンフォントをflexコンテナで中央揃えするための調整 */
    line-height: 1; 
}

/* (★) アイコンボタン (背景=Sub / アイコン=Main) */
.btn.btn-icon-primary {
    background-color: var(--color-semantic-primary-sub);
    color: var(--color-semantic-primary-main);
    border-color: var(--color-semantic-primary-sub);
}

.btn.btn-icon-success {
    background-color: var(--color-semantic-success-sub);
    color: var(--color-semantic-success-main);
    border-color: var(--color-semantic-success-sub);
}

/* (★追記) */
.btn.btn-icon-warning {
    background-color: var(--color-semantic-warning-sub);
    color: var(--color-semantic-warning-main);
    border-color: var(--color-semantic-warning-sub);
}

.btn.btn-icon-error {
    background-color: var(--color-semantic-error-sub);
    color: var(--color-semantic-error-main);
    border-color: var(--color-semantic-error-sub);
}

.btn.btn-icon-neutral {
    background-color: var(--color-semantic-neutral-sub);
    color: var(--color-semantic-neutral-main);
    border-color: var(--color-semantic-neutral-sub);
}

/* (★追記) */
.btn.btn-icon-cancelled {
    background-color: var(--color-semantic-cancelled-sub);
    color: var(--color-semantic-cancelled-main);
    border-color: var(--color-semantic-cancelled-sub);
}

/* (★) アイコンボタン内部のアイコン (span) のズレを微調整 */
.btn.btn-icon > span {
    position: relative;
    left: 0.5px;
}

/* -------------------------------------- */
/* 5.4. フォーム (Form) (★変更)
/* -------------------------------------- */
.form-group {
    margin-bottom: var(--spacing-stack-md);
}

/* (★ラベルのスタイルを「データリスト」に合わせる) */
.form-label {
    display: block;
    font-weight: var(--font-weight-light); /* (★ 300 に変更) */
    color: var(--color-base-quaternary); /* (★ #666 に変更) */
    margin-bottom: var(--spacing-stack-xs);
    font-size: var(--font-size-xs); /* 12.8px */
}

.input-field {
    display: block;
    width: 100%;
    background-color: var(--color-input-background);
    border: var(--border-width-sm) solid var(--color-input-border);
    border-radius: var(--radius-input);
    padding: var(--spacing-input-padding-y) var(--spacing-input-padding-x);
    transition: border-color var(--transition-duration-fast) var(--transition-timing-ease),
                box-shadow var(--transition-duration-fast) var(--transition-timing-ease);
    font-size: var(--font-size-sm); /* ★ 16px (標準) を明示 */
}

.input-field::placeholder {
    color: var(--color-input-placeholder);
}

.input-field:focus {
    outline: none;
    border-color: var(--color-input-border-focus);
    box-shadow: 0 0 0 3px var(--color-semantic-primary-sub);
}

.input-field.is-error {
    border-color: var(--color-input-border-error);
}
.input-field.is-error:focus {
    box-shadow: 0 0 0 3px var(--color-semantic-error-sub);
}

.form-error-message {
    color: var(--color-input-text-error);
    font-size: var(--font-size-xs); /* 12.8px */
    margin-top: var(--spacing-stack-xs);
}

/* (★ <select> のスタイルを .input-field と共通化) */
select.input-field {
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%23666666'%3E%3Cpath fill-rule='evenodd' d='M10 13.293l-4.646-4.647a.5.5 0 0 1 .708-.708L10 11.879l4.939-4.939a.5.5 0 0 1 .708.708L10 13.293z' clip-rule='evenodd'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right var(--spacing-3) center;
    background-size: 1.25em 1.25em;
    padding-right: var(--spacing-8); /* 矢印の分、右に余白 */
}

/* (★ <input type="number"> のスピナー非表示) */
input[type="number"].input-field::-webkit-inner-spin-button,
input[type="number"].input-field::-webkit-outer-spin-button {
    appearance: none;
    margin: 0;
}
input[type="number"].input-field {
    -moz-appearance: textfield;
}

/* -------------------------------------- */
/* 5.5. バッジ (Badge)
/* (★セマンティックカラー全対応)
/* -------------------------------------- */
.badge {
    display: inline-block;
    padding: var(--spacing-badge-padding-y) var(--spacing-badge-padding-x);
    font-size: var(--font-size-xs); /* ★ 12.8px */
    font-weight: var(--font-weight-bold); /* ★ 700 */
    border-radius: var(--radius-badge);
    line-height: 1;
    text-transform: uppercase;
}

/* (★追記) */
.badge-primary {
    background-color: var(--color-semantic-primary-sub);
    color: var(--color-semantic-primary-main);
}

.badge-success {
    background-color: var(--color-badge-success-background);
    color: var(--color-badge-success-text);
}

.badge-warning {
    background-color: var(--color-badge-warning-background);
    color: var(--color-badge-warning-text);
}

.badge-error {
    background-color: var(--color-badge-error-background);
    color: var(--color-badge-error-text);
}

/* (★追記) */
.badge-neutral {
    background-color: var(--color-semantic-neutral-sub);
    color: var(--color-semantic-neutral-main);
}

/* (★追記) */
.badge-cancelled {
    background-color: var(--color-semantic-cancelled-sub);
    color: var(--color-semantic-cancelled-main);
}

/* -------------------------------------- */
/* 5.6. テーブル (Table) (★★変更★★)
/* -------------------------------------- */
.table-container {
    width: 100%;
    overflow-x: auto;
    /* (★) 修正: 親の .card が外枠になるため、border と border-radius を削除  */
    
    /* ↓ コメントを解除して、テーブルコンテナ自身の罫線を有効化 */
    border: var(--border-width-sm) solid var(--color-table-container-border);
    border-radius: var(--radius-card);
}

.table {
    width: 100%;
    border-collapse: collapse;
    background-color: var(--color-base-primary);
}

.table th,
.table td {
    padding: var(--spacing-table-cell-padding-y) var(--spacing-table-cell-padding-x);
    text-align: left;
    /* (★★行の罫線を補助罫線(EEE)に変更★★) */
    border-bottom: var(--border-width-sm) solid var(--color-table-border);
}

/* (★ヘッダー(TH)のスタイルを「ラベル」に合わせる) */
.table th {
    background-color: var(--color-table-header-background);
    font-weight: var(--font-weight-light); /* (★ 300) */
    font-size: var(--font-size-xs);
    color: var(--color-base-quaternary); /* (★ #666) */
    /* (★ヘッダーの下罫線のみ基本罫線(CCC)に戻す) */
    border-bottom-color: var(--color-base-quinary); 
}

/* (★データ(TD)のスタイルを「値」に合わせる) */
.table td {
    font-size: var(--font-size-sm);
    color: var(--color-base-tertiary); /* (★ #333) */
    font-weight: var(--font-weight-regular); /* (★ 500) */
}

.table tbody tr:hover {
    background-color: var(--color-table-row-background-hover);
}

.table tr:last-child td {
    border-bottom: none;
}

/* -------------------------------------- */
/* 5.7. モーダル (Modal)
/* -------------------------------------- */
.modal-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: var(--color-modal-backdrop-background);
    z-index: var(--z-index-modal-backdrop);
    display: flex;
    justify-content: center;
    align-items: center;
}

.modal-content {
    background-color: var(--color-modal-content-background);
    border-radius: var(--radius-modal);
    box-shadow: var(--shadow-modal);
    padding: var(--spacing-modal-padding);
    width: 90%;
    max-width: 600px;
    z-index: var(--z-index-modal);
}

.modal-header {
    font-size: var(--font-size-md); /* ★ 20px */
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--spacing-stack-md);
}

.modal-body {
    margin-bottom: var(--spacing-stack-md);
}

.modal-footer {
    text-align: right;
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-stack-sm);
}

/* -------------------------------------- */
/* 5.8. アラート (Alert)
/* -------------------------------------- */
[class^="alert-"] {
    padding: var(--spacing-alert-padding);
    border-radius: var(--radius-alert);
    border: var(--border-width-sm) solid transparent;
    font-weight: var(--font-weight-medium); /* ★ 600 */
}
.alert-success {
    background-color: var(--color-alert-success-background);
    color: var(--color-alert-success-text);
    border-color: var(--color-alert-success-border);
}
.alert-error {
    background-color: var(--color-alert-error-background);
    color: var(--color-alert-error-text);
    border-color: var(--color-alert-error-border);
}

/* -------------------------------------- */
/* 5.9. タブ (Tabs)
/* -------------------------------------- */
.tabs-nav {
    display: flex;
    border-bottom: var(--border-width-md) solid var(--color-tab-border);
    margin-bottom: var(--spacing-stack-md);
}
.tab-link {
    padding: var(--spacing-tab-padding-y) var(--spacing-tab-padding-x);
    border-bottom: var(--border-width-md) solid transparent;
    margin-bottom: -2px;
    cursor: pointer;
    color: var(--color-tab-text);
    font-weight: var(--font-weight-medium); /* ★ 600 */
    transition: all var(--transition-duration-fast) var(--transition-timing-ease);
}
.tab-link:hover {
    color: var(--color-tab-text-active);
}
.tab-link.is-active {
    color: var(--color-tab-text-active);
    border-color: var(--color-tab-border-active);
}

.tab-content {
    display: none;
}
.tab-content.is-active {
    display: block;
}

/* -------------------------------------- */
/* 5.10. スピナー (Spinner)
/* -------------------------------------- */
@keyframes spinner-rotate {
    to { transform: rotate(360deg); }
}
.spinner {
    width: 2rem;
    height: 2rem;
    border: 4px solid var(--color-spinner-track);
    border-top-color: var(--color-spinner-thumb);
    border-radius: 50%;
    animation: spinner-rotate 0.8s linear infinite;
}

/* -------------------------------------- */
/* 5.11. パンくずリスト (Breadcrumb)
/* -------------------------------------- */
.breadcrumb {
    display: flex;
    align-items: center;
    font-size: var(--font-size-xs); /* ★ 12.8px */
    color: var(--color-base-quaternary);
}
.breadcrumb-item {
    display: flex;
    align-items: center;
}
.breadcrumb-item a {
    color: var(--color-semantic-primary-main);
}
.breadcrumb-item:not(:last-child)::after {
    content: '>';
    margin: 0 var(--spacing-2);
    color: var(--color-base-quinary);
}

/* -------------------------------------- */
/* 5.12. データリスト (Data List) (★変更)
/* -------------------------------------- */
.data-list {
    margin: 0;
    padding: 0;
}
.data-list > dt {
    font-size: var(--font-size-xs); /* 12.8px */
    font-weight: var(--font-weight-light); /* (★ 300 に変更) */
    color: var(--color-data-list-label-text); /* #666 */
    padding-top: var(--spacing-data-list-padding-y); /* 12px */
}
.data-list > dd {
    font-size: var(--font-size-sm); /* 16px */
    font-weight: var(--font-weight-regular); /* 500 */
    color: var(--color-data-list-value-text); /* #333 */
    margin: 0;
    padding-bottom: var(--spacing-data-list-padding-y); /* 12px */
    border-bottom: var(--color-data-list-border); /* 補助罫線(EEE) */
}
.data-list > dt:not(:first-child) {
    padding-top: var(--spacing-data-list-padding-y);
}
.data-list > dd:last-child {
    border-bottom: none;
}

/* -------------------------------------- */
/* 5.13. サイドバー (Sidebar) (★変更)
/* -------------------------------------- */
.sidebar-header {
    padding: var(--spacing-inset-lg); 
    font-size: var(--font-size-lg); 
    font-weight: var(--font-weight-bold);
    display: flex;
    align-items: center;
    justify-content: center; 
    background-color: var(--color-theme-main); 
    color: var(--color-theme-accent); 
    border-bottom: 1px solid var(--palette-translucent-2552); 
    flex-shrink: 0;
}

.sidebar-nav {
    flex-grow: 1;
    padding: var(--spacing-inset-sm);
    overflow-y: auto;
    /* (★) スクロールバー非表示 (Firefox) */
    scrollbar-width: none;
}

/* (★) スクロールバー非表示 (Chrome, Safari, Edge) */
.sidebar-nav::-webkit-scrollbar {
    display: none;
}

.nav-accordion {
    margin-bottom: var(--spacing-stack-xs);
}
.nav-accordion summary {
    padding: var(--spacing-2) var(--spacing-3);
    cursor: pointer;
    border-radius: var(--radius-button);
    font-weight: var(--font-weight-medium);
    list-style: none; /* マーカーを消す */
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color var(--transition-duration-fast) var(--transition-timing-ease);
}
.nav-accordion summary::-webkit-details-marker {
    display: none; /* Chrome */
}
.nav-accordion summary::after {
    content: '►'; /* (★) 閉: 右向き */
    font-size: 0.8em;
    transition: transform var(--transition-duration-fast) ease;
}
.nav-accordion[open] summary::after {
    transform: rotate(90deg); /* (★) 開: 下向き (90度回転) */
}
.nav-accordion:hover summary {
    background-color: var(--palette-translucent-2552);
}

.nav-link {
    display: block; 
    padding: var(--spacing-2) var(--spacing-3);
    margin-bottom: var(--spacing-stack-xs);
    border-radius: var(--radius-button);
    font-weight: var(--font-weight-medium);
    color: var(--color-base-primary); 
    text-decoration: none;
    transition: background-color var(--transition-duration-fast) var(--transition-timing-ease);
}
.nav-link:hover {
    background-color: var(--palette-translucent-2552);
    opacity: 1;
}

.sidebar-nav ul {
    list-style: none;
    padding: 0;
    margin: var(--spacing-stack-xs) 0;
}
.sidebar-nav ul a {
    display: block;
    color: var(--color-base-primary);
    text-decoration: none;
    /* (★) 修正: padding-left を --spacing-8 (2rem) に変更 */
    padding: var(--spacing-2) var(--spacing-3) var(--spacing-2) var(--spacing-8);
    border-radius: var(--radius-button);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-regular);
    transition: background-color var(--transition-duration-fast) var(--transition-timing-ease);
}
.sidebar-nav ul a:hover {
    background-color: var(--palette-translucent-2552);
    opacity: 1; /* a タグのグローバルホバー(0.7)を上書き */
}

.sidebar-footer {
    padding: var(--spacing-inset-md);
    border-top: 1px solid var(--palette-translucent-2552);
    flex-shrink: 0;
    text-align: center; /* (★) 中央揃え */
}
.user-info {
    font-size: var(--font-size-sm);
}
.user-info .user-name {
    display: block;
    font-weight: var(--font-weight-bold);
    margin-bottom: var(--spacing-stack-xs);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
.user-info a {
    color: var(--palette-CEF); /* 明るいリンク色 */
    font-size: var(--font-size-xs);
    display: inline-block; /* (★) 中央揃えのため */
}
.user-info a:hover {
    opacity: 0.8;
}

/* -------------------------------------- */
/* 5.14. フォーム (Check & Radio) (★新規追加)
/* -------------------------------------- */
.form-check {
    display: flex;
    align-items: center;
    margin-bottom: var(--spacing-3); /* 12px */
}
.form-check-input {
    appearance: none;
    -webkit-appearance: none;
    background-color: var(--color-input-background);
    border: var(--border-width-sm) solid var(--color-input-border);
    padding: 0;
    margin: 0;
    
    display: inline-block;
    width: 1.25em; /* 20px (16px * 1.25) */
    height: 1.25em; /* 20px */
    position: relative;
    cursor: pointer;
    transition: all var(--transition-duration-fast) var(--transition-timing-ease);
    flex-shrink: 0; /* ラベルに押されて縮まないように */
}
.form-check-input:focus {
    outline: none;
    border-color: var(--color-input-border-focus);
    box-shadow: 0 0 0 3px var(--color-semantic-primary-sub);
}

/* チェックボックス (四角) */
.form-check-input[type="checkbox"] {
    border-radius: var(--border-radius-sm); /* 4px */
}
/* チェックボックス (チェックマーク) */
.form-check-input[type="checkbox"]:checked::after {
    content: '';
    display: block;
    width: 0.35em; /* 5.6px */
    height: 0.7em; /* 11.2px */
    border: solid var(--color-base-primary); /* 白 */
    border-width: 0 3px 3px 0;
    transform: rotate(45deg);
    position: absolute;
    left: 0.35em; /* 5.6px */
    top: 0.1em; /* 1.6px */
}

/* ラジオボタン (丸) */
.form-check-input[type="radio"] {
    border-radius: 50%;
}
/* ラジオボタン (中の点) */
.form-check-input[type="radio"]:checked::after {
    content: '';
    display: block;
    width: 0.75em; /* 12px */
    height: 0.75em; /* 12px */
    border-radius: 50%;
    background-color: var(--color-base-primary); /* 白 */
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}

/* 共通のチェック/選択済みスタイル */
.form-check-input:checked {
    background-color: var(--color-theme-main);
    border-color: var(--color-theme-main);
}

.form-check-label {
    /* (★値と同様のスタイルを適用) */
    font-size: var(--font-size-sm); /* 16px */
    font-weight: var(--font-weight-regular); /* 500 */
    color: var(--color-base-tertiary); /* #333 */
    padding-left: var(--spacing-2); /* 8px */
    cursor: pointer;
}